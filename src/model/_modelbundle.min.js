LostAndFound.Model.ParseHelper={copyAttributes:function(n,t){var i=t.attributes;for(var r in i)n[r]=i[r];n.id=t.id},copyArray:function(n,t){var i=[],u,f,r;for(u in n)f=n[u],r=t?t():{},this.copyAttributes(r,f),i.push(r);return console.log(i),i}};LostAndFound.Model.UserModel=function(){var n={},t=function(){return n};return n.init=t,n}();LostAndFound.Model.CommentsModel=function(){var n={},t=function(){return n},i=function(){};return n.getReportsComments=i,n.init=t,n}();LostAndFound.Model.GeoModel=function(){var n={},t={lng:10,lat:50},i=function(){return n},r=function(){return t},u=function(n){function r(i){i&&alert("Geolocation service failed.");n(t)}var i=new Boolean;navigator.geolocation?(i=!0,navigator.geolocation.getCurrentPosition(function(i){t.lng=i.coords.longitude;t.lat=i.coords.latitude;n(t)},function(){r(i)})):(i=!1,r(i))};return n.getDefaultLocation=r,n.getCurrentLocation=u,n.init=i,n}();LostAndFound.Model.ReportsModel=function(){var n={},t=Parse.Object.extend("report"),e=["lat","lng","getCategoryName","getType","imageURL","category"],i=[],o=function(){return n},s=function(n,t){t(i[n])},h=function(n,i){var u=new t,o,h,l,a,s;for(o in n)(h=n[o],e.indexOf(o)>=0)||(console.log(o,h),u.set(o,n[o]));l=new Parse.GeoPoint(n.lat,n.lng);a=f(n.category.id);u.set("category",a);u.set("location",l);n.imageURL?(s=c(n.imageURL),s.save().then(function(){u.set("image",s);r(u,i)},function(n){console.log(n)})):r(u,i)},r=function(n,t){n.save({success:function(){t.success()},error:function(n){console.log(n)}})},c=function(n){var t={base64:n};return new Parse.File("afile",t)},l=function(n,t){var i=u(n);i.count({success:function(n){t.success(n);console.log(n)},error:function(n){console.log(n)}})},u=function(n){var i=new Parse.Query(t),r=n.sector,u,f,e;return i.equalTo("type",n.type),u=a(n.itemTypes),console.log(u),i.containedIn("category",u),f=new Parse.GeoPoint(r.latMin,r.longMin),e=new Parse.GeoPoint(r.latMax,r.longMax),i.withinGeoBox("location",e,f),i},a=function(n){for(var i=[],t=0;t<n.length;t++)i.push(f(n[t]));return i},f=function(n){var i=Parse.Object.extend("category"),t=new i;return t.set("id",n),t},v=function(n){var t=LostAndFound.Model.ParseHelper.copyArray(n,function(){return new LostAndFound.Model.Report});return t&&t.forEach(function(n){if(n){if(i[n.id]=n,n.category){var t=n.category.id,r=LostAndFound.Model.ConfigModel.getItemTypeForId(t);n.category=r}n.image&&(n.imageURL=n.image.url());n.location&&(n.lng=n.location.longitude,n.lat=n.location.latitude)}}),t},y=function(n,t){var i=u(n);i.limit=n.pageSize;i.skip=n.offset;i.find({success:function(n){t(v(n))},error:function(n){console.log(n)}})};return n.getReportsCount=l,n.saveReport=h,n.getReport=s,n.getReports=y,n.init=o,n}();LostAndFound.Model.ConfigModel=function(){var n={},i=Parse.Object.extend("category"),t=[],r=function(){return n},u=function(n){return LostAndFound.Model.ParseHelper.copyArray(n)},f=function(n){return t[n]},e=function(n){t&&n(t);console.log("getting item types!!");var r=new Parse.Query(i);r.find({success:function(i){var r=u(i);r.forEach(function(n){t[n.id]=n});n(r)},error:function(n){console.log(n)}})};return n.getItemTypeForId=f,n.getItemTypes=e,n.init=r,n}();
/*
//# sourceMappingURL=_modelbundle.min.js.map
*/