LostAndFound.Model.ParseHelper={copyAttributes:function(n,t){var i=t.attributes;for(var r in i)n[r]=i[r];n.id=t.id},copyArray:function(n,t){var i=[],u,f,r;for(u in n)f=n[u],r=t?t():{},this.copyAttributes(r,f),i.push(r);return console.log(i),i}};LostAndFound.Model.UserModel=function(){var n={},t=function(){return n};return n.init=t,n}();LostAndFound.Model.CommentsModel=function(){var n={},t=function(){return n},i=function(){};return n.getReportsComments=i,n.init=t,n}();LostAndFound.Model.GeoModel=function(){var n={},t={lng:10,lat:50},i=function(){return n},r=function(){return t},u=function(n){function r(i){i&&alert("Geolocation service failed.");n(t)}var i=new Boolean;navigator.geolocation?(i=!0,navigator.geolocation.getCurrentPosition(function(i){t.lng=i.coords.longitude;t.lat=i.coords.latitude;n(t)},function(){r(i)})):(i=!1,r(i))};return n.getDefaultLocation=r,n.getCurrentLocation=u,n.init=i,n}();LostAndFound.Model.ReportsModel=function(){var n={},i=Parse.Object.extend("report"),o=["lat","lng","imageURL","category"],t=[],s=function(){return n},h=function(n,i){if(t[n]){i(t[n]);return}},c=function(n,t){var u=new i,e,h,c,a,s;for(e in n)(h=n[e],h instanceof Function||o.indexOf(e)>=0)||u.set(e,n[e]);c=new Parse.GeoPoint(n.lat,n.lng);a=f(n.category.id);u.set("category",a);u.set("location",c);n.imageURL?(s=l(n.imageURL),s.save().then(function(){u.set("image",s);r(u,t)},function(n){console.log(n)})):r(u,t)},r=function(n,t){n.save({success:function(){var i=e([n])[0];t.success(i)},error:function(n){console.log(n)}})},l=function(n){var t={base64:n};return new Parse.File("afile",t)},a=function(n,t){var i=u(n);i.count({success:function(n){t.success(n)},error:function(n){console.log(n)}})},u=function(n){var t=new Parse.Query(i),r=n.sector,u,f,e;return t.equalTo("type",n.type),u=v(n.itemTypes),t.containedIn("category",u),f=new Parse.GeoPoint(r.latMin,r.longMin),e=new Parse.GeoPoint(r.latMax,r.longMax),t.withinGeoBox("location",e,f),t},v=function(n){for(var i=[],t=0;t<n.length;t++)i.push(f(n[t]));return i},f=function(n){var i=Parse.Object.extend("category"),t=new i;return t.set("id",n),t},e=function(n){var i=LostAndFound.Model.ParseHelper.copyArray(n,function(){return new LostAndFound.Model.Report});return i&&i.forEach(function(n){if(n){if(t[n.id]=n,n.category){var i=n.category.id,r=LostAndFound.Model.ConfigModel.getItemTypeForId(i);n.category=r}n.image&&(n.imageURL=n.image.url());n.location&&(n.lng=n.location.longitude,n.lat=n.location.latitude)}}),i},y=function(n,t){var i=u(n);i.limit(n.pageSize);i.skip(n.offset);i.descending("createdAt");i.find({success:function(n){t(e(n))},error:function(n){console.log(n)}})};return n.getReportsCount=a,n.saveReport=c,n.getReport=h,n.getReports=y,n.init=s,n}();LostAndFound.Model.ConfigModel=function(){var n={},i=Parse.Object.extend("category"),t={},r=function(){return n},u=function(n){return LostAndFound.Model.ParseHelper.copyArray(n)},f=function(n){return t[n]},e=function(n){if(LostAndFound.Model.Categories&&LostAndFound.Model.Categories.length>0){n(LostAndFound.Model.Categories);return}var r=LostAndFound.Model.Categories=[],f=new Parse.Query(i);f.find({success:function(i){var f=u(i);f.forEach(function(n){t[n.id]=n;r.push(n)});n(f)},error:function(n){console.log(n)}})};return n.getItemTypeForId=f,n.getItemTypes=e,n.init=r,n}();
/*
//# sourceMappingURL=_modelbundle.min.js.map
*/