
var cities = [{ "name": "Berlin", "lat": 52.524368165134284, "lng": 13.410530090332031 }, { "name": "Prague", "lat": 50.0880428938909, "lng": 14.4207572937012 }, { "name": "Luxembourg", "lat": 49.6116667, "lng": 6.13 }, { "name": "Hamburg", "lat": 53.575323, "lng": 10.01534 }, { "name": "München", "lat": 48.1374325498109, "lng": 11.5754914283752 }, { "name": "Köln", "lat": 50.9333333, "lng": 6.95 }, { "name": "Frankfurt am Main", "lat": 50.11552, "lng": 8.684167 }, { "name": "Stuttgart", "lat": 48.7823242931971, "lng": 9.17701721191406 }, { "name": "Essen", "lat": 51.45657, "lng": 7.012282 }, { "name": "Düsseldorf", "lat": 51.2217225723832, "lng": 6.77616119384766 }, { "name": "Bremen", "lat": 53.075155679403, "lng": 8.80777359008789 }, { "name": "Hannover", "lat": 52.3705162650448, "lng": 9.73322153091431 }, { "name": "Leipzig", "lat": 51.33962, "lng": 12.371292 }, { "name": "Nürnberg", "lat": 49.45420526135589, "lng": 11.077523231506348 }, { "name": "Dresden", "lat": 51.05089108097961, "lng": 13.738317489624023 }, { "name": "Szczecin", "lat": 53.42894375294566, "lng": 14.553022384643555 }, { "name": "Zürich", "lat": 47.3666667, "lng": 8.55 }, { "name": "Bielefeld", "lat": 52.0333333, "lng": 8.5333333 }, { "name": "Bonn", "lat": 50.73438, "lng": 7.095485 }, { "name": "Mannheim", "lat": 49.496706, "lng": 8.479547 }, { "name": "Strasbourg", "lat": 48.58392, "lng": 7.74553 }, { "name": "Karlsruhe", "lat": 49.009365, "lng": 8.40444 }, { "name": "Münster", "lat": 51.9623559078618, "lng": 7.62571334838867 }, { "name": "Aachen", "lat": 50.776635609734, "lng": 6.08342170715332 }, { "name": "Augsburg", "lat": 48.371538, "lng": 10.898514 }, { "name": "Chemnitz", "lat": 50.835701, "lng": 12.929217 }, { "name": "Kiel", "lat": 54.32132926107913, "lng": 10.1348876953125 }, { "name": "Magdeburg", "lat": 52.127731, "lng": 11.629163 }, { "name": "Freiburg", "lat": 47.9958954102206, "lng": 7.85222053527832 }, { "name": "Erfurt", "lat": 50.978695, "lng": 11.032831 }, { "name": "Lübeck", "lat": 53.8689270437681, "lng": 10.6872940063477 }, { "name": "Hagen", "lat": 51.360811, "lng": 7.471679 }, { "name": "Rostock", "lat": 54.0886975425419, "lng": 12.140493392944336 }, { "name": "Kassel", "lat": 51.3166667, "lng": 9.5 }, { "name": "Saarbrücken", "lat": 49.235396, "lng": 6.981646 }, { "name": "Groningen", "lat": 53.219167, "lng": 6.566667 }, { "name": "Linz", "lat": 48.3063888888, "lng": 14.286111111 }, { "name": "Hamm", "lat": 51.6803258163791, "lng": 7.82089233398438 }, { "name": "Basel", "lat": 47.558395, "lng": 7.573271 }, { "name": "Pilsen", "lat": 49.7474748191057, "lng": 13.3775874056586 }, { "name": "Osnabrück", "lat": 52.272642, "lng": 8.049799 }, { "name": "Salzburg", "lat": 47.79940564350643, "lng": 13.043990135192871 }, { "name": "Nijmegen", "lat": 51.8425, "lng": 5.852778 }, { "name": "Enschede", "lat": 52.218333, "lng": 6.895833 }, { "name": "Paderborn", "lat": 51.71905281158757, "lng": 8.754386901855469 }, { "name": "Darmstadt", "lat": 49.871674, "lng": 8.650271 }, { "name": "Besançon", "lat": 47.248778, "lng": 6.018152 }, { "name": "Apeldoorn", "lat": 52.21, "lng": 5.969444 }, { "name": "Metz", "lat": 49.1191075673371, "lng": 6.17268562316895 }, { "name": "Würzburg", "lat": 49.793912, "lng": 9.951214 }, { "name": "Regensburg", "lat": 49.034512, "lng": 12.119234 }, { "name": "Wolfsburg", "lat": 52.424516, "lng": 10.781499 }, { "name": "Innsbruck", "lat": 47.2626600380713, "lng": 11.3945388793945 }, { "name": "Göttingen", "lat": 51.53443, "lng": 9.93228 }, { "name": "Zwolle", "lat": 52.5125, "lng": 6.094444 }, { "name": "Ingolstadt", "lat": 48.765081, "lng": 11.423725 }, { "name": "Ulm", "lat": 48.39840839176684, "lng": 9.99155044555664 }, { "name": "Bremerhaven", "lat": 53.550209, "lng": 8.576735 }, { "name": "Reutlingen", "lat": 48.49143998430753, "lng": 9.204268455505371 }, { "name": "Koblenz", "lat": 50.353573, "lng": 7.578835 }, { "name": "Siegen", "lat": 50.874815, "lng": 8.02431 }, { "name": "Schwerin", "lat": 53.629371148263694, "lng": 11.413164138793945 }, { "name": "České Budějovice", "lat": 48.9744684295676, "lng": 14.4743405558585 }, { "name": "Nancy", "lat": 48.68438756783516, "lng": 6.184959411621094 }, { "name": "Jena", "lat": 50.928782, "lng": 11.589901 }, { "name": "Gera", "lat": 50.8802935991031, "lng": 12.081871032714844 }, { "name": "Ústí nad Labem", "lat": 50.660703797446, "lng": 14.032272043438 }, { "name": "Hildesheim", "lat": 52.1507653455965, "lng": 9.95112419128418 }, { "name": "Born", "lat": 51.031667, "lng": 5.809722 }, { "name": "Marl", "lat": 51.656706, "lng": 7.090381 }, { "name": "Flensburg", "lat": 54.78431, "lng": 9.439611 }, { "name": "Cottbus", "lat": 51.757691, "lng": 14.328875 }, { "name": "Minden", "lat": 52.289532, "lng": 8.914552 }, { "name": "Konstanz", "lat": 47.66032930790168, "lng": 9.17581558227539 }, { "name": "Neumünster", "lat": 54.074773, "lng": 9.981954 }, { "name": "Dessau", "lat": 51.83864138900479, "lng": 12.245550155639648 }, { "name": "Arnsberg", "lat": 51.3833333, "lng": 8.0833333 }, { "name": "Bayreuth", "lat": 49.947823, "lng": 11.578935 }, { "name": "Gießen", "lat": 50.58727, "lng": 8.675536 }, { "name": "Assen", "lat": 52.996667, "lng": 6.5625 }, { "name": "Lüneburg", "lat": 53.250897, "lng": 10.414087 }, { "name": "Celle", "lat": 52.622643223928605, "lng": 10.08047103881836 }, { "name": "Neubrandenburg", "lat": 53.564144, "lng": 13.275319 }, { "name": "Aalen", "lat": 48.837774762760944, "lng": 10.093302726745605 }, { "name": "Plauen", "lat": 50.497305, "lng": 12.137823 }, { "name": "Fulda", "lat": 50.55161672492041, "lng": 9.675178527832031 }, { "name": "Karlovy Vary", "lat": 50.2327126073114, "lng": 12.8711700439453 }, { "name": "Wesel", "lat": 51.666897, "lng": 6.620367 }, { "name": "Kempten (Allgäu)", "lat": 47.72673854412002, "lng": 10.313887596130371 }, { "name": "Landshut", "lat": 48.529612, "lng": 12.161791 }, { "name": "Rosenheim", "lat": 47.85636625513179, "lng": 12.122468948364258 }, { "name": "Stralsund", "lat": 54.30911285820068, "lng": 13.081798553466797 }, { "name": "Görlitz", "lat": 51.155177777445, "lng": 14.988527297973633 }, { "name": "Emmen", "lat": 52.779167, "lng": 6.906944 }, { "name": "Belfort", "lat": 47.6333333, "lng": 6.8666667 }, { "name": "Schweinfurt", "lat": 50.04936829874445, "lng": 10.221748352050781 }, { "name": "Nordhorn", "lat": 52.43080972861878, "lng": 7.068328857421875 }, { "name": "Greifswald", "lat": 54.093107, "lng": 13.387857 }, { "name": "Cuxhaven", "lat": 53.8717610367494, "lng": 8.690872192382812 }, { "name": "Frankfurt (Oder)", "lat": 52.3471378230352, "lng": 14.5506191253662 }, { "name": "Passau", "lat": 48.56649801144473, "lng": 13.431215286254883 }, { "name": "Chomutov", "lat": 50.4604754244385, "lng": 13.4177855818421 }, { "name": "Albstadt", "lat": 48.21643786815753, "lng": 9.025955200195312 }, { "name": "Wismar", "lat": 53.893145, "lng": 11.452859 }, { "name": "Amberg", "lat": 49.442872, "lng": 11.862672 }, { "name": "Lahr", "lat": 48.340419, "lng": 7.868864 }, { "name": "Eisenach", "lat": 50.980701, "lng": 10.315221 }, { "name": "Mladá Boleslav", "lat": 50.4113513240651, "lng": 14.9031849587442 }, { "name": "Hoyerswerda", "lat": 51.437874, "lng": 14.23549 }, { "name": "Goslar", "lat": 51.904248279647504, "lng": 10.427656173706055 }, { "name": "Suhl", "lat": 50.609111, "lng": 10.694009 }, { "name": "Dornbirn", "lat": 47.4142657985086, "lng": 9.741954803466797 }, { "name": "Weiden", "lat": 49.676824, "lng": 12.156126 }, { "name": "Eberswalde", "lat": 52.83492123113255, "lng": 13.819513320922852 }, { "name": "Coburg", "lat": 50.259366, "lng": 10.963843 }, { "name": "Memmingen", "lat": 47.9837174333001, "lng": 10.185270309448242 }, { "name": "Aurich", "lat": 53.469193, "lng": 7.482319 }, { "name": "Steyr", "lat": 48.042742317061474, "lng": 14.421272277832031 }, { "name": "Épinal", "lat": 48.1833333, "lng": 6.45 }, { "name": "Venray", "lat": 51.525, "lng": 5.975 }, { "name": "Mühlhausen", "lat": 51.208959, "lng": 10.452753 }, { "name": "Schwedt (Oder)", "lat": 53.05963204603705, "lng": 14.281539916992188 }, { "name": "Stendal", "lat": 52.606895, "lng": 11.858671 }, { "name": "Riesa", "lat": 51.307765, "lng": 13.29168 }, { "name": "Schwäbisch Hall", "lat": 49.1112705055637, "lng": 9.739079475402832 }, { "name": "Tábor", "lat": 49.4144124595458, "lng": 14.6578033918673 }, { "name": "Příbram", "lat": 49.6898773919801, "lng": 14.0104252278605 }, { "name": "Uelzen", "lat": 52.96572, "lng": 10.561106 }, { "name": "Tuttlingen", "lat": 47.984644, "lng": 8.817702 }, { "name": "Papenburg", "lat": 53.077379, "lng": 7.404436 }, { "name": "Nienburg", "lat": 52.646102, "lng": 9.220856 }, { "name": "Eisenhüttenstadt", "lat": 52.15, "lng": 14.65 }, { "name": "Neuruppin", "lat": 52.92815364890322, "lng": 12.803106307983398 }, { "name": "Idar-Oberstein", "lat": 49.714426, "lng": 7.307764 }, { "name": "Güstrow", "lat": 53.7972036759587, "lng": 12.17336654663086 }, { "name": "Cloppenburg", "lat": 52.847538, "lng": 8.045 }, { "name": "Forchheim", "lat": 49.717542888321425, "lng": 11.058769226074219 }, { "name": "Bad Nauheim", "lat": 50.3646272530591, "lng": 8.738594055175781 }, { "name": "Písek", "lat": 49.3087953307231, "lng": 14.1475028622414 }, { "name": "Gaggenau", "lat": 48.8, "lng": 8.3333333 }, { "name": "Lennestadt", "lat": 51.117214, "lng": 8.06707 }, { "name": "Saalfeld", "lat": 50.648259, "lng": 11.365363 }, { "name": "Sankt Wendel", "lat": 49.466326, "lng": 7.168142 }, { "name": "Zittau", "lat": 50.897724, "lng": 14.807644 }, { "name": "Aarau", "lat": 47.39253902496185, "lng": 8.04422378540039 }, { "name": "Wolvega", "lat": 52.875453, "lng": 5.996908 }, { "name": "Roth", "lat": 49.247625, "lng": 11.091111 }, { "name": "Korbach", "lat": 51.27560874067112, "lng": 8.873004913330078 }, { "name": "Walsrode", "lat": 52.861468, "lng": 9.592601 }, { "name": "Ludwigsfelde", "lat": 52.303219, "lng": 13.254049 }, { "name": "Schleswig", "lat": 54.521561, "lng": 9.558598 }, { "name": "Sangerhausen", "lat": 51.472209, "lng": 11.295333 }, { "name": "Klatovy", "lat": 49.395520092879, "lng": 13.295054908569 }, { "name": "Staßfurt", "lat": 51.851863, "lng": 11.585079 }, { "name": "Bad Mergentheim", "lat": 49.4925, "lng": 9.7736111 }, { "name": "Neustrelitz", "lat": 53.361303, "lng": 13.072916 }, { "name": "Stadtallendorf", "lat": 50.822609, "lng": 9.012941 }, { "name": "Luckenwalde", "lat": 52.090293, "lng": 13.167717 }, { "name": "Germersheim", "lat": 49.2230556, "lng": 8.3638889 }, { "name": "Heide", "lat": 54.195794, "lng": 9.098797 }, { "name": "Wittenberge", "lat": 53.005434, "lng": 11.750317 }, { "name": "Rastede", "lat": 53.25, "lng": 8.2 }, { "name": "Vesoul", "lat": 47.6333333, "lng": 6.1666667 }, { "name": "Parchim", "lat": 53.42630998319161, "lng": 11.8487548828125 }, { "name": "Aalten", "lat": 51.925, "lng": 6.580556 }, { "name": "Borna", "lat": 51.124164, "lng": 12.496385 }, { "name": "Torgau", "lat": 51.56016, "lng": 12.996166 }, { "name": "Aue", "lat": 50.590336, "lng": 12.706568 }]

var application;

function renderCity(req, res) {
    var name = req.params.name;
    var requestedname = name.charAt(0).toUpperCase() + name.slice(1);;
    var crawled = application.isCrawled(req);

    name = requestedname.toLowerCase();

    for (var i = 0; i < cities.length; i++) {
        var city = cities[i];
        name = name.replace(/ä/g, "ae").replace(/ö/g, "oe").replace(/ü/g, "ue").replace(/ß/g, "ss");
        var cityName = city.name.toLowerCase().replace(/ä/g, "ae").replace(/ö/g, "oe").replace(/ü/g, "ue").replace(/ß/g, "ss");

        if (cityName == name) {
            if (crawled) {
                res.render('static_city_index', { city: city });
                return;
            }
            res.render('index', { city: city });
            return;
        }
    }
};


module.exports = function (app) {
    application = app;
    app.locals.cities = cities;

    app.get("/stadt/:name", function (req, res) {
        renderCity(req, res);
    });

    app.get("/city/:name", function (req, res) {
        renderCity(req, res);
    });
}

